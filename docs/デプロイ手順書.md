# デプロイ手順書：Tabiori-Scrap

本ドキュメントは、Tabiori-Scrapアプリケーションを本番環境（Vercel）へデプロイし、一般公開するための手順をまとめたものです。

## 1. 前提条件
*   GitHubのリポジトリ (`main` ブランチ) が最新の状態であること。
*   Supabaseプロジェクトが作成済みであり、`trips`, `timeline_items` テーブルおよび `trip-photos` バケットが設定済みであること。
*   Vercelアカウント、Google Cloud Consoleアカウントを所持していること。

## 2. Vercelへのデプロイ
すでにCLI経由で初期デプロイは完了していますが、Webコンソールからの手順も記載します。

### 2.1 プロジェクト作成
1.  [Vercel Dashboard](https://vercel.com/dashboard) にアクセス。
2.  「**Add New ...**」 > 「**Project**」をクリック。
3.  GitHubリポジトリ `Tabiori-Scrap` を選択して **Import**。

### 2.2 環境変数の設定
デプロイ設定画面、または `Settings` > `Environment Variables` にて以下を設定します。

| 変数名 | 設定値の取得元 |
| --- | --- |
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase Dashboard > Settings > API > Project URL |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase Dashboard > Settings > API > anon key |

### 2.3 デプロイ実行
設定完了後、**Deploy**（または **Redeploy**）を実行します。
成功すると、本番URL（例: `https://tabiori-scrap.vercel.app`）が発行されます。

## 3. 認証設定の更新 (重要)
デプロイされたドメインでGoogleログインを動作させるために、外部サービスの許可リスト設定が必要です。

### 3.1 Supabase Redirect URL
1.  Supabase Dashboard > **Authentication** > **URL Configuration** へ移動。
2.  **Redirect URLs** に、発行された本番URLのコールバックを追加します。
    *   形式: `https://<本番ドメイン>/auth/callback`
    *   例: `https://tabiori-scrap.vercel.app/auth/callback`
3.  **Save** をクリック。

### 3.2 Google Cloud Console
1.  **Google Cloud Console** > **APIとサービス** > **認証情報** へ移動。
2.  使用している「OAuth 2.0 クライアント ID」の編集画面を開く。
3.  **承認済みのリダイレクト URI** に、上記と同じURLを追加します。
    *   例: `https://tabiori-scrap.vercel.app/auth/callback`
4.  **保存** をクリック。

## 4. 動作確認項目
全ての設定完了後、本番URLにアクセスして以下を確認してください。

1.  **Googleログイン**: クリック後、Googleの認証画面を経てアプリに戻れること。
2.  **旅行作成**: 新しい旅行を作成し、詳細画面へ遷移できること。
3.  **アイテム追加**: 予定と写真を追加できること。特に写真は画像が表示されること。
4.  **リアルタイム同期**: 別ブラウザ/スマホで開いた際、追加内容が即座に反映されること。

---
以上でリリース作業は完了です。
